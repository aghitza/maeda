\documentclass[11pt]{article}

\usepackage[english]{babel}
\usepackage{csquotes}
\usepackage[style=alphabetic, 
            hyperref=auto,
            url=true,
            isbn=false,
            doi=false,
            block=none,
            maxnames=10,
            backend=biber]{biblatex}
\addbibresource{maeda.bib}
\renewcommand{\bibfont}{\normalfont\small}

\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}

\usepackage[pagewise, mathlines]{lineno}
\linenumbers
\modulolinenumbers[2]

\usepackage{gitinfo}
\usepackage[english]{isodate}

\usepackage{geometry}
\usepackage{numprint}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}

\numberwithin{equation}{section}
\numberwithin{table}{section}
\renewcommand{\labelenumi}{(\arabic{enumi})}
\newcommand{\longto}{\longrightarrow}

\newcommand{\CC}{\mathbb{C}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cH}{\mathcal{H}}
\renewcommand{\SS}{\mathfrak{S}}
\renewcommand{\Im}{\operatorname{Im}}

\newcommand{\bound}{\numprint{10000}}

\newcommand{\GL}{\mathrm{GL}}
\newcommand{\SL}{\mathrm{SL}}

\cleanlookdateon
\title{Experimental evidence for Maeda's conjecture on modular forms\footnote{Commit: \gitAbbrevHash{} on \printdate{\gitAuthorDate{}}}
}
\author{
Alexandru Ghitza\footnote{Research of the first author was supported by 
a Discovery Grant from the Australian Research Council.}  
{} and 
Angus McAndrew\\
Department of Mathematics and Statistics\\
University of Melbourne\\
{\tt aghitza@gmail.com}, {\tt mcandrew@student.unimelb.edu.au}
}
\date{}


\begin{document}
\thispagestyle{empty}

\maketitle
\begin{abstract}
  We describe a computational verification of Maeda's conjecture for the Hecke
  operator $T_2$ in all weights less than $\bound$.
\end{abstract}


\section{Introduction}

TODO: Motivation.

We review some basic definitions and properties of modular forms.  For
details, the reader is invited to consult~\cite{Stein}.

Let $k\in\ZZ$.  A \emph{modular form} of level $1$ and weight $k$ is a
holomorphic function
\begin{equation*}
  f\colon\cH\longto\CC, \quad\text{where }
  \cH=\{z\in\CC\mid \Im z>0\},
\end{equation*}
satisfying
\begin{itemize}
  \item Modularity: for all $z\in\cH$ and all
    $g=\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)\in\SL_2(\ZZ)$,
      \begin{equation*}
        f\left(\frac{az+b}{cz+d}\right)=(cz+d)^kf(z).
      \end{equation*}
  \item Holomorphicity at $i\infty$: a holomorphic function $f$ satisfying the
    modularity condition satisfies $f(z+1)=f(z)$ for all $z\in\cH$, so it has
    a Fourier expansion
    \begin{equation*}
      f(z)=\sum_{n=-\infty}^\infty a_nq^n,\quad\text{where we set }
      q=e^{2\pi i z}.
    \end{equation*}
    We ask for $f$ to be \emph{holomorphic at $i\infty$}, i.e. that $a_n=0$
    for all $n<0$.
\end{itemize}

We say that a modular form $f$ is a \emph{cusp form} if $a_0=0$.  The cusp
forms of weight $k$ form a vector space $S_k$.  These vector spaces are
equipped with a family of \emph{Hecke operators} $T_m$ (for $m\in\NN$), whose
effect on the Fourier expansion $f(q)=\sum a_nq^n$ of $f\in S_k$ is given by
\begin{equation*}
  (T_m f)(q)=\sum_{n=1}^\infty \left(\sum_{d\mid\gcd(m,n)}d^{k-1}a_{mn/d^2}\right)q^n.
\end{equation*}

The complex vector space $S_k$ has dimension 
\begin{equation*}
  d=\begin{cases}
    \left[\frac{k}{12}\right]-1 & \text{if }k\equiv 2\pmod{12},\\
    \left[\frac{k}{12}\right] & \text{if }k\not\equiv 2\pmod{12}.
  \end{cases}
\end{equation*}

\begin{conjecture}[Maeda~\cite{Maeda}]
  Let $m>1$ and 
  let $F$ be the characteristic polynomial of the Hecke operator $T_m$ acting
  on $S_k$.  Then 
  \begin{enumerate}
    \item the polynomial $F$ is irreducible over $\QQ$;
    \item the Galois group of the splitting field of $F$ is the full symmetric
      group $\SS_d$, where $d$ is the dimension of $S_k$.
  \end{enumerate}
\end{conjecture}

TODO: Describe (relevant) previous results:
Buzzard,
Conrey-Farmer,
William Stein's student?,
Chu-Wee Lim PhD thesis?,
Ahlgren


\section{The basic lemma and density estimates}

Consider a polynomial $F\in\ZZ[X]$ of degree $d$.
Given a prime $p$, we denote by
$F_p\in\FF_p[X]$ the reduction modulo $p$ of $F$.  We say that the prime
$p$ is
\begin{enumerate}
  \item \emph{of type I} if $F_p$ is irreducible over $\FF_p$;
  \item \emph{of type II} if $F_p$ factors over $\FF_p$ into a product of
    distinct irreducible factors
    \begin{equation*}
      F_p=f_0f_1\cdots f_t
    \end{equation*}
    with
    \begin{align*}
      \deg f_0 &= 2\\
      \deg f_j &\text{ odd for }j=1,\ldots,t;
    \end{align*}
  \item \emph{of type III} if $F_p$ factors over $\FF_p$ into a product of
    distinct irreducible factors
    \begin{equation*}
      F_p=f_0f_1\cdots f_t
    \end{equation*}
    with $\deg f_0>d/2$ and prime.
\end{enumerate}

Note that these types are not necessarily mutually exclusive: a prime of type I
is clearly also of type III in the case where $d$ is prime.

The computational approach to Maeda's conjecture is based on the following
result, first proved in a special case in~\cite{Buzzard} and then generalized
in~\cite{ConreyFarmer}.

\begin{lemma}[Buzzard-Conrey-Farmer]
  Let $F\in\ZZ[X]$ be a monic polynomial of degree $d$.  Suppose that $F$ has
  primes $p$, $q$ and $r$ of respective types $I$, $II$ and $III$.  Then $F$
  is irreducible over $\QQ$ and its splitting field over $\QQ$ has full Galois
  group $\SS_d$.
\end{lemma}
\begin{proof}
  TODO
\end{proof}

TODO: reference for Frobenius's theorem

\begin{theorem}[Frobenius]
  Let $F\in\ZZ[X]$ be monic and separable (having distinct roots over
  $\overline{\QQ}$, i.e. $\gcd(F, F^\prime)=1$).  Let $K/\QQ$ be the splitting
  field of $F$ and let $G$ be the Galois group of $K/\QQ$.  
  Let $\deg F=m_1d_1+\ldots+m_td_t$ be a partition of $\deg F$.  
  The density of primes $p$ for which the factorization of $F_p$ is of the
  form
  \begin{equation*}
    F_p=f_1\cdots f_t\quad\text{with }f_j\in\FF_p[X], \deg f_j=d_j,
  \end{equation*}
  is equal to
  \begin{equation*}
    \frac{\sharp\{\sigma\in G\mid\text{the cycle pattern of $\sigma$ is 
    $d_1^{m_1}\ldots d_t^{m_t}$}\}
    }{\sharp G}
  \end{equation*}
\end{theorem}

In the remainder of this section, we estimate the density of primes of types
I, II and III.

\begin{lemma}
  Let an element $\sigma$ of $\SS_d$ have cycle type $d_1^{m_1}d_2^{m_2}\ldots d_t^{m_t}$, 
  where $m_i$ is the number of times a cycle of length $d_i$ appears in the cycle
  decomposition of $\sigma$. (Note: $m_1d_1+m_2d_2+\ldots +m_td_t=d$.) The number
   of elements of $\SS_d$ of cycle type $d_1^{m_1}d_2^{m_2}\ldots d_t^{m_t}$ is equal to
  \begin{equation*}
    C(d_1^{m_1}d_2^{m_2}\ldots d_t^{m_t})=\frac{d!}{\prod_{j=1}^t\left(d_j^{m_j}m_j!\right)}.
  \end{equation*}

  %Let $d=d_1+\ldots+d_t$ be a partition of the positive integer $d$.  For each
  %integer $j=1,\ldots,d$, let $m_j$ denote the number of times it appears in
  %the partition.  The
  %number of elements of $\SS_d$ of cycle type $d_1,\ldots,d_t$ is equal to
  %\begin{equation*}
  %  C(d_1,\ldots,d_t)=\frac{d!}{\prod_{j=1}^d\left(j^{m_j} m_j!\right)}.
  %\end{equation*}

  %TODO: make this more clear (use a partition $\lambda$, etc.)
\end{lemma}
\begin{proof}
  Consider $\SS_d$, with elements of cycle type $d_1^{m_1} d_2^{m_2} \ldots d_t^{m_t}$, 
  where $m_i$ is the number of times a $d_i$-cycle appears in the decomposition.
  There are $d!$ ways to arrange $d$ elements.
  For each of the $m_i$ $d_i$-cycles, one can rotate the cycle $d_i$ ways and retrieve the 
  same cycle. Thus must divide by $d_i^{m_i}$ for $i \in \{1,2,\ldots,t\}$.
  Disjoint cycles commute, so the $m_i$ $d_i$-cycles can be permuted amongst one another 
  $m_i!$ ways without changing the element. Thus must divide by $m_i!$ for $i \in \{1,2,\ldots,t\}$.
  Thus
  \begin{equation*}
    \frac{d!}{\prod_{j=1}^t d_i^{m_i} m_i!}.
  \end{equation*}
\end{proof}

\begin{proposition}
  The density of primes of type I is $\frac{1}{d}$.
\end{proposition}
\begin{proof}
  Primes of type I correspond to $d$-cycles in $\SS_d$, i.e. elements with 
  cycle type $d$. Applying Lemma 2.3, we see
  \begin{equation*}
    C(d)=\frac{d!}{d^1}=(d-1)!
  \end{equation*}
  Thus, by Theorem 2.2, the density of primes of type I is
  \begin{equation*}
    \frac{(d-1)!}{d!}=\frac{1}{d}.
  \end{equation*}
\end{proof}

\begin{proposition}
  The density of primes of type II is ...
\end{proposition}
\begin{proof}
  TODO
\end{proof}

\begin{proposition}
  The density of primes of type III is ...
\end{proposition}
\begin{proof}
  TODO
\end{proof}


\section{Implementation and results}
We implemented the basic approach described in the previous section
using the mathematical software Sage, see~\cite{Sage}.

Here is what we do for a fixed weight $k$:
\begin{enumerate}
  \item Compute the Victor Miller basis $\cB$ for $S_k$ up to precision
    $2(d+2)$, where $d$ is the dimension of $S_k$.
  \item Compute the matrix $M$ of the Hecke operator $T_2$ with respect to the
    basis $\cB$ -- this is very efficient since the basis $\cB$ is
    echelonized.
  \item\label{itm:random} Pick a random prime $p<2^{20}$.
  \item Reduce $M$ modulo $p$ and compute the characteristic polynomial
    $F_p\in \FF_p[X]$.
  \item Is $F_p$ irreducible?  If so, $p$ is a prime of type $I$.
  \item Factor $F_p$ over $\FF_p$ and use this factorization to decide whether
    $p$ is a prime of type $II$ or $III$.
  \item Repeat from step~(\ref{itm:random}) until we have found at
    least one prime of each type.
\end{enumerate}

TODO: find out which component of Sage is used in the main steps.

TODO: get timings for each main step for a large weight $k$.

TODO: run a consecutive version of this algorithm (going through primes in
order, from $p=2$ on) and see how it compares to our randomized approach.

\begin{theorem}[Maeda's conjecture holds for weights $\leq \bound$]
  Let $k\leq \bound$ and let $F$ be the characteristic polynomial of the
  Hecke operator $T_2$ acting on the space $S_k$ of cusp forms of weight
  $k$ and level $1$.  Then $F$ is irreducible over $\QQ$ and the Galois
  group of its splitting field is the full symmetric group $\SS_d$, 
  where $d$ is the dimension of the space $S_k$.
\end{theorem}


TODO: Describe the probability distribution we observe for the different types
of primes.

TODO: State some corollaries (look in the references for some nice
consequences).


\printbibliography

\end{document}


