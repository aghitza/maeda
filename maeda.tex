\documentclass[11pt]{article}

\usepackage[english]{babel}
\usepackage{csquotes}
\usepackage[style=alphabetic, 
            hyperref=auto,
            url=true,
            isbn=false,
            doi=false,
            block=none,
            maxnames=10,
            backend=biber]{biblatex}
\addbibresource{maeda.bib}
\renewcommand{\bibfont}{\normalfont\small}

\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{amsmath}

% \usepackage[pagewise, mathlines]{lineno}
% \linenumbers
% \modulolinenumbers[2]

%\usepackage{gitinfo}
%\usepackage[english]{isodate}

\usepackage[a4paper, top=3cm, bottom=3cm]{geometry}
\usepackage[a4paper]{geometry}
\usepackage{numprint}
\usepackage[pdftex]{graphicx}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}

\numberwithin{equation}{section}
\numberwithin{table}{section}
\renewcommand{\labelenumi}{(\arabic{enumi})}
\newcommand{\longto}{\longrightarrow}

\newcommand{\CC}{\mathbb{C}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\FF}{\mathbb{F}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\NN}{\mathbb{N}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cH}{\mathcal{H}}
\renewcommand{\SS}{\mathfrak{S}}
\renewcommand{\Im}{\operatorname{Im}}
\newcommand{\Frob}{\operatorname{Frob}}
\newcommand{\Gal}{\operatorname{Gal}}

\newcommand{\bound}{\numprint{10000}}

\newcommand{\GL}{\mathrm{GL}}
\newcommand{\SL}{\mathrm{SL}}

%\cleanlookdateon
\title{Experimental evidence for Maeda's conjecture on modular forms
%\footnote{Commit: \gitAbbrevHash{} on \printdate{\gitAuthorDate{}}}
}
\author{
Alexandru Ghitza\footnote{Research of the first author was supported by 
a Discovery Grant from the Australian Research Council.}  
{} and 
Angus McAndrew\\
Department of Mathematics and Statistics\\
University of Melbourne\\
{\tt aghitza@gmail.com}, {\tt mcandrew@student.unimelb.edu.au}
}
\date{}


\begin{document}
\thispagestyle{empty}

\maketitle
\begin{abstract}
  We describe a computational verification of Maeda's conjecture for the Hecke
  operator $T_2$ in all weights less than $\bound$.
\end{abstract}


\section{Introduction}
Modular forms come in many different types.  One of the most attractive
aspects of their study is that, despite the apparent variety of definitions
and properties, there are some universal guiding principles (such as the
Langlands program) that serve to unify and motivate this diversity.  On the
other hand, there are some special properties that seem to occur in isolation.
One such instance is provided by a conjecture formulated by Maeda, which
indicates a behavior that seems to be specific to modular forms of level one
on $\GL_2$.  

TODO: Motivation.

We review some basic definitions and properties of modular forms.  For
details, the reader is invited to consult~\cite{Stein}.

Let $k\in\ZZ$.  A \emph{modular form} of level $1$ and weight $k$ is a
holomorphic function
\begin{equation*}
  f\colon\cH\longto\CC, \quad\text{where }
  \cH=\{z\in\CC\mid \Im z>0\},
\end{equation*}
satisfying
\begin{itemize}
  \item Modularity: for all $z\in\cH$ and all
    $g=\left(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\right)\in\SL_2(\ZZ)$,
      \begin{equation*}
        f\left(\frac{az+b}{cz+d}\right)=(cz+d)^kf(z).
      \end{equation*}
  \item Holomorphicity at $i\infty$: a holomorphic function $f$ satisfying the
    modularity condition satisfies $f(z+1)=f(z)$ for all $z\in\cH$, so it has
    a Fourier expansion
    \begin{equation*}
      f(z)=\sum_{n=-\infty}^\infty a_nq^n,\quad\text{where we set }
      q=e^{2\pi i z}.
    \end{equation*}
    We ask for $f$ to be \emph{holomorphic at $i\infty$}, i.e. that $a_n=0$
    for all $n<0$.
\end{itemize}

We say that a modular form $f$ is a \emph{cusp form} if $a_0=0$.  The cusp
forms of weight $k$ form a vector space $S_k$.  These vector spaces are
equipped with a family of \emph{Hecke operators} $T_m$ (for $m\in\NN$), whose
effect on the Fourier expansion $f(q)=\sum a_nq^n$ of $f\in S_k$ is given by
\begin{equation*}
  (T_m f)(q)=\sum_{n=1}^\infty \left(\sum_{d\mid\gcd(m,n)}d^{k-1}a_{mn/d^2}\right)q^n.
\end{equation*}

The complex vector space $S_k$ has dimension 
\begin{equation*}
  d=\begin{cases}
    \left[\frac{k}{12}\right]-1 & \text{if }k\equiv 2\pmod{12},\\
    \left[\frac{k}{12}\right] & \text{if }k\not\equiv 2\pmod{12}.
  \end{cases}
\end{equation*}

\begin{conjecture}[Maeda~\cite{Maeda}]
  Let $m>1$ and 
  let $F$ be the characteristic polynomial of the Hecke operator $T_m$ acting
  on $S_k$.  Then 
  \begin{enumerate}
    \item the polynomial $F$ is irreducible over $\QQ$;
    \item the Galois group of the splitting field of $F$ is the full symmetric
      group $\SS_d$, where $d$ is the dimension of $S_k$.
  \end{enumerate}
\end{conjecture}

The conjecture has enjoyed constant attention over the last 15 years, with
theoretical as well as computational results.  We summarize the computational
verifications in Table~\ref{tbl:known}.

\begin{table}[h]
  \begin{center}
\begin{tabular}{l|r}
  Source & weights\\ \hline
  Buzzard~\cite{Buzzard} & $12\ell$, $\ell$ prime, $2\leq\ell\leq 19$ \\
  Maeda~\cite{Maeda} & $k\leq 468$ \\
  Conrey-Farmer~\cite{ConreyFarmer} & $k\leq 500$, $k\equiv 0\pmod 4$  \\
  Farmer-James~\cite{FarmerJames} & $k\leq \numprint{2000}$  \\
  Buzzard-Stein, Kleinerman~\cite{Kleinerman} & $k\leq\numprint{3000}$ \\
  Chu-Wee Lim~\cite{Lim} & $k\leq\numprint{6000}$ \\
  present paper & $k\leq\bound$  \\
\end{tabular}
\end{center}
\caption{Summary of known cases of Maeda's conjecture for $T_2$}
\label{tbl:known}
\end{table}

The theoretical results focus on whether the validity of the conjecture for
some given operator $T_m$ can be used to deduce the conjecture for other
operators $T_n$.  We state three such results.

\begin{theorem}[Conrey-Farmer-Wallace~\cite{ConreyFarmerWallace}]
  \label{thm:CFW}
  Let $k$ be a positive even integer.  Suppose there exists $n\geq 2$ such
  that the operator $T_n$ acting on $S_k$ satisfies Maeda's conjecture.  Then
  so does $T_p$ acting on $S_k$, for every prime $p$ such that
  \begin{equation*}
    p\not\equiv \pm 1\pmod{5}\qquad\text{or}\qquad
    p\not\equiv \pm 1\pmod{7}.
  \end{equation*}
\end{theorem}

\begin{theorem}[Baba-Murty~\cite{BabaMurty}]
  Let $k$ be a positive even integer.  Suppose there exists a prime $p$ such
  that the characteristic polynomial of $T_p$ acting on $S_k$ is irreducible
  over $\QQ$.  Then there exists $\delta>0$ such that
  \begin{equation*}
    \#\{\ell\leq N\mid \text{charpoly}(T_\ell|S_k)\text{ is reducible}\}
    \ll \frac{N}{(\log N)^{1+\delta}}.
  \end{equation*}
\end{theorem}

\begin{theorem}[Ahlgren~\cite{Ahlgren}]\label{thm:Ahl}
  Let $k$ be such that $d:=\dim S_k\geq 2$.  Suppose there exists $n\geq 2$
  such that the operator $T_n$ acting on $S_k$ satisfies Maeda's conjecture.
  Then
  \begin{enumerate}
    \item $T_p$ acting on $S_k$ satisfies Maeda's conjecture for all primes
      $p\leq\numprint{4000000}$;
    \item $T_n$ acting on $S_k$ satisfies Maeda's conjecture for all
      $n\leq\numprint{10000}$.
  \end{enumerate}
\end{theorem}




\section{The basic lemma and density estimates}
\label{sect:density}

Consider a polynomial $F\in\ZZ[X]$ of degree $d$.
Given a prime $p$, we denote by
$F_p\in\FF_p[X]$ the reduction modulo $p$ of $F$.  We say that the prime
$p$ is
\begin{enumerate}
  \item \emph{of type I} if $F_p$ is irreducible over $\FF_p$;
  \item \emph{of type II} if $F_p$ factors over $\FF_p$ into a product of
    distinct irreducible factors
    \begin{equation*}
      F_p=f_0f_1\cdots f_t
    \end{equation*}
    with
    \begin{align*}
      \deg f_0 &= 2\\
      \deg f_j &\text{ odd for }j=1,\ldots,t;
    \end{align*}
  \item \emph{of type III} if $F_p$ factors over $\FF_p$ into a product of
    distinct irreducible factors
    \begin{equation*}
      F_p=f_0f_1\cdots f_t
    \end{equation*}
    with $\deg f_0>d/2$ and prime.
\end{enumerate}

\begin{remark}
These types are not necessarily mutually exclusive: if $d$ itself is
prime, then a prime $p$ of type I is clearly also of type III.
\end{remark}

\begin{remark}
In either of the three types, the conditions imply that the reduced polynomial
$F_p$ is separable (i.e. it has distinct roots over $\overline{\FF}_p$).

TODO: briefly explain why.
  
Thus $F_p = f_0 f_1 \ldots f_{t_1}$ and
  $F_q = g_0 g_1 \ldots g_{t_2}$, with $\deg f_0 = 2$ and $\deg g_0 > d/2$ is prime.
  Thus the roots of $F_p$ and $F_q$ are distinct, since any of the $f_i$ or $g_i$ has
  distinct roots, and if any two factors share a root then either their product is
  reducible or the factors are equal to one another. Since this contradicts our
  assumption on the factorisations of $F_p$ and $F_q$, they must have distinct roots.
\end{remark}

The computational approach to Maeda's conjecture is based on the following
result, first proved in a special case in~\cite{Buzzard} and then generalized
in~\cite{ConreyFarmer}.

\begin{lemma}[Buzzard-Conrey-Farmer]
  Let $F\in\ZZ[X]$ be a monic polynomial of degree $d$.  Suppose that $F$ has
  primes $\ell$, $p$ and $q$ of respective types I, II and III.  Then $F$
  is irreducible over $\QQ$ and its splitting field over $\QQ$ has full Galois
  group $\SS_d$.
\end{lemma}
\begin{proof}
  The fact that $F$ is irreducible is immediate from the existence of a prime of type
  I. 
  Let $K/\QQ$ be the splitting field of $F$ and let $G$ be the Galois group of
  $K/\QQ$.  Thus $G$ is a transitive subgroup of $\SS_d$. 

  TODO: Distinct roots mod $p$ implies $\Frob_{\mathfrak{p}} \in G$ for
  $\mathfrak{p}$
  a prime of $K$ above $p$.

  TODO: $\Frob_{\mathfrak{p}}$ has cycle decomposition which is the same as the
  decomposition of $F_p$.

  So $\Frob_{\mathfrak{p}}$ has cycle type $2,\deg(f_1),\ldots,\deg(f_{t_1})$ and
  $\Frob_{\mathfrak{q}}$ has cycle type $\ell,\deg(g_1),\ldots,\deg(g_{t_2})$, where 
  $p>d/2$ is prime. Thus for $x_1=\prod_{i=1}^{t_1}\deg f_i$ and $x_2=\prod_{i=1}^{t_2}\deg g_i$,
  we have that $(\Frob_{\mathfrak{q}})^{x_1}$ is a transposition and 
  $(\Frob_{\mathfrak{r}})^{x_2}$
  is a cycle of length $p$. The fact that these elements are in $G$ implies $G=\SS_d$ as follows:
  Put an equivalence relation $\sim$ on $S=\{1,2,\ldots,d\}$ by $a\sim b$ if $a=b$ or if the
  transposition $(a~b)$ is in $G$. Since $G$ is
  transitive, each equivalence class has the same number of elements, denote this
  $n$, and it follows that $n|d$. Note that $n>1$ since $G$ contains at least one
  transposition. Let $T=\{e_1,e_2,\ldots,e_p\}$ be the subset of $S$ permuted by
  ($\Frob_{\mathfrak{r}})^{x_2}$, and let $G_T$ be the subgroup of $G$ fixing $S\setminus T$.
  Define an equivalence relation on $T$ by $a\simeq b$ if $a=b$ or if the transposition
  $(a~b) \in G_T$. As before, each equivalence class has the same number of elements,
  say $m$, and $m\mid p$. Since $n>1$, we have $m>1$, so $m=p$ since $p$ is prime.
  But $n\geq m$ because $G_T\subset G$. Thus $n>d/2$, so $n=d$. This implies $G=\SS_d$. 
\end{proof}

TODO: reference for Frobenius's theorem

\begin{theorem}[Frobenius]\label{thm:frobenius}
  Let $F\in\ZZ[X]$ be monic and separable (having distinct roots over
  $\overline{\QQ}$, i.e. $\gcd(F, F^\prime)=1$).  Let $K/\QQ$ be the splitting
  field of $F$ and let $G$ be the Galois group of $K/\QQ$.  
  Let $\deg F=m_1d_1+\ldots+m_td_t$ be a partition of $\deg F$.  
  The density of primes $p$ for which the factorization of $F_p$ is of the
  form
  \begin{equation*}
    F_p=f_1\cdots f_t\quad\text{with }f_j\in\FF_p[X], \deg f_j=d_j,
  \end{equation*}
  is equal to
  \begin{equation*}
    \frac{\#\{\sigma\in G\mid\text{the cycle pattern of $\sigma$ is 
    $d_1^{m_1}\ldots d_t^{m_t}$}\}
    }{\# G}
  \end{equation*}
\end{theorem}

In the remainder of this section, we estimate the density of primes of types
I, II and III.

\begin{lemma}\label{lem:cycletype}
  Let an element $\sigma$ of $\SS_d$ have cycle type $d_1^{m_1}d_2^{m_2}\ldots d_t^{m_t}$, 
  where $m_i$ is the number of times a cycle of length $d_i$ appears in the cycle
  decomposition of $\sigma$. (Note: $m_1d_1+m_2d_2+\ldots +m_td_t=d$.) The number
   of elements of $\SS_d$ of cycle type $d_1^{m_1}d_2^{m_2}\ldots d_t^{m_t}$ is equal to
  \begin{equation*}
    C(d_1^{m_1}d_2^{m_2}\ldots d_t^{m_t})=\frac{d!}{\prod_{j=1}^t\left(d_j^{m_j}m_j!\right)}.
  \end{equation*}

  %Let $d=d_1+\ldots+d_t$ be a partition of the positive integer $d$.  For each
  %integer $j=1,\ldots,d$, let $m_j$ denote the number of times it appears in
  %the partition.  The
  %number of elements of $\SS_d$ of cycle type $d_1,\ldots,d_t$ is equal to
  %\begin{equation*}
  %  C(d_1,\ldots,d_t)=\frac{d!}{\prod_{j=1}^d\left(j^{m_j} m_j!\right)}.
  %\end{equation*}

  %TODO: make this more clear (use a partition $\lambda$, etc.)
\end{lemma}
\begin{proof}
  Consider $\SS_d$, with elements of cycle type $d_1^{m_1} d_2^{m_2} \ldots d_t^{m_t}$, 
  where $m_i$ is the number of times a $d_i$-cycle appears in the decomposition.
  There are $d!$ ways to arrange $d$ elements.
  For each of the $m_i$ $d_i$-cycles, one can rotate the cycle $d_i$ ways and retrieve the 
  same cycle. Thus must divide by $d_i^{m_i}$ for $i \in \{1,2,\ldots,t\}$.
  Disjoint cycles commute, so the $m_i$ $d_i$-cycles can be permuted amongst one another 
  $m_i!$ ways without changing the element. Thus must divide by $m_i!$ for $i \in \{1,2,\ldots,t\}$.
  Thus
  \begin{equation*}
    \frac{d!}{\prod_{j=1}^t d_i^{m_i} m_i!}.
  \end{equation*}
\end{proof}

\begin{proposition}\label{prop:type1}
  The density of primes of type I is 
  \begin{equation*}
    D_I(d)=\frac{1}{d}.
  \end{equation*}
\end{proposition}
\begin{proof}
  Primes of type I correspond to $d$-cycles in $\SS_d$, i.e. elements with 
  cycle type $d$. Applying Lemma~\ref{lem:cycletype}, we see
  \begin{equation*}
    C(d)=\frac{d!}{d^1}=(d-1)!
  \end{equation*}
  Thus, by Theorem~\ref{thm:frobenius}, the density of primes of type I is
  \begin{equation*}
    \frac{(d-1)!}{d!}=\frac{1}{d}.
  \end{equation*}
\end{proof}

\begin{proposition}\label{prop:type2}
  The density of primes of type II is given by\footnote{Recall that the \emph{double factorial} is...}
  \begin{align*}
    D_{II}(1)&=1,\\
    D_{II}(d)&=\begin{cases}
        \frac{1}{2(d-2)!}\left((d-3)!!\right)^2,&\text{if }d\text{ is even and }d>2\\
        \frac{1}{2(d-2)!}\left((d-4)!!\right)^2(d-2),&\text{if }d\text{ is odd and }d>3
    \end{cases}
  \end{align*}
  Would this be nicer as the following?
  \begin{equation*}
    D(d)=\binom{d}{2}\prod_{i=1}^{d-2}\left(2\left\lfloor\frac{i-1}{2}\right\rfloor+1\right)
  \end{equation*}
  TODO: Include lower bound
\end{proposition}
\begin{proof}
  Primes of type II correspond to elements in $\SS_d$ containing a 2-cycle and no other
  even cycles. There are $\binom{d}{2}$ 2-cycles in $\SS_d$, since one merely chooses
  2 elements where order is irrelevant. Thus, fixing an arbitrary 2-cycle, we determine
  the number of elements of odd order in $\SS_{d-2}$. This is given by the following sequence:
  \begin{align*}
    1, 1, 3, 9, 45, 225, 1575, 11025, 99225, 893025, \ldots
  \end{align*}
\end{proof}

\begin{proposition}
  The density of primes of type III is
  \begin{equation*}
    D_{III}(d)=\sum_{d/2<\ell\leq d, \,\ell\text{ prime}} \frac{1}{\ell}.
  \end{equation*}
  If $d>2$, then
  \begin{equation*}
    D_{III}(d)>\frac{1}{d}.
  \end{equation*}
\end{proposition}
\begin{proof}
  Fix a prime $\ell$ such that $d/2<\ell\leq d$.  According to
  Theorem~\ref{thm:frobenius}, we need to count the number of elements of
  $\SS_d$ that contain an $\ell$-cycle.  Choosing the $\ell$-cycle itself
  involves the $\binom{d}{\ell}$ ways of picking its constituents, which can
  then be rearranged within the cycle in $(\ell-1)!$ ways.  It remains to
  take into account the number of permutations of the remaining $d-\ell$ symbols,
  so overall we have
  \begin{equation*}
    \binom{d}{\ell}(\ell-1)!(d-\ell)!=\frac{d!}{\ell}
  \end{equation*}
  elements of $\SS_d$ containing an $\ell$-cycle, which gives the stated
  density.

  The inequality given in the statement follows from Bertrand's postulate
  (proved by Chebyshev), which says that for any integer $n>1$ there is at
  least one prime $\ell$ such that $n<\ell<2n$.
\end{proof}

We can get a much better lower bound on the density $D_{III}$ by using some
recent results of Dusart on explicit estimates for sums over primes.

\begin{theorem}[Dusart, Theorem 6.10 in~\cite{Dusart}]
  Let $B\approx 0.26149$ denote the Meissel-Mertens constant.  For
  all $x>1$ we have
  \begin{equation}\label{eq:rec_lower}
    \log\log x+B-\left(\frac{1}{10\log^2 x}+\frac{4}{15\log^3 x}\right)\leq
    \sum_{p\leq x}\frac{1}{p}.
  \end{equation}
\end{theorem}

We will also need an upper bound on the sum of the reciprocals of primes up to
$x$, but Dusart's upper bound only holds for $x\geq\numprint{10372}$.  For our
purposes, the following weaker result is sufficient: for all $x>1$ we have
\begin{equation}\label{eq:rec_upper}
  \sum_{p\leq x}\frac{1}{p}\leq\log\log x + B +\frac{1}{\log^2 x}.
\end{equation}
(This inequality can be found in Theorem 8.8.5 of~\cite{BachShallit}.)

\begin{proposition}\label{prop:type3}
  If $d>10$, then
  \begin{equation*}
    D_{III}(d)>\frac{1}{3\log d}.
  \end{equation*}
\end{proposition}
\begin{proof}
  We put together inequalities~\eqref{eq:rec_lower} and~\eqref{eq:rec_upper}
  to get
  \begin{equation*}
    D_{III}(d)>\log\log d-\log\log\frac{d}{2}-\frac{1}{10\log^2 d}
    -\frac{4}{15\log^3 d}-\frac{1}{\log^2\frac{d}{2}}.
  \end{equation*}
  We write
  \begin{equation*}
    \log\log d - \log\log\frac{d}{2} =\log\left(1+\frac{\log 2}{\log d-\log
    2}\right)
  \end{equation*}
  and use the inequality
  \begin{equation*}
    \log(1+x)\geq x-\frac{x^2}{2}+\frac{x^3}{3}-\frac{x^4}{4}
    \qquad\text{for all }1<x\leq 1
  \end{equation*}
  to get that for all $d\geq 4$
  \begin{align*}
    D_{III}(d)&>\frac{1}{\log d-\log 2}&\left[
      \log 2
      -\left(\frac{\log^2 2}{2}+\frac{11}{10}\right)\frac{1}{\log d-\log
      2}\right.\\
      &&\left. -\left(\frac{4}{15}-\frac{\log^3 2}{3}\right)\frac{1}{(\log d-\log 2)^2}
      -\frac{\log^4 2}{4}\frac{1}{(\log d-\log 2)^3}
      \right]\\
      &>\frac{1}{\log d}&\left[
      0.693-1.341\frac{1}{\log d-\log 2}
      -0.156\frac{1}{(\log d-\log 2)^2}\right.\\
      &&\left.-0.058\frac{1}{(\log d-\log 2)^3}
      \right]
  \end{align*}
  If $d>94$, then the expression in the brackets is bigger than $1/3$, and we
  get the desired inequality.  We check that it holds for the remaining cases
  $10<d\leq 94$ by computation.
\end{proof}



\section{Implementation and results}
Our approach is a randomized version of the algorithm
from~\cite{ConreyFarmer}, based on the results introduced in the previous
section.  We implemented this algorithm using the mathematical software Sage, 
see~\cite{Sage}.

Here is what we do for a fixed weight $k$:
\begin{enumerate}
  \item\label{itm:vmbasis} Compute the Victor Miller basis $\cB$ for $S_k$ up to precision
    $2(d+2)$, where $d$ is the dimension of $S_k$.
  \item\label{itm:hecke} Compute the matrix $M$ of the Hecke operator $T_2$ with respect to the
    basis $\cB$ -- this is very efficient since the basis $\cB$ is
    echelonized.
  \item\label{itm:random} Pick a random prime $p<2^{20}$. (This choice of upper
    bound gives a large enough range so that it is likely to contain primes of
    type we are looking for, but not so large that the arithmetic over $\FF_p$
    gets too expensive.)
  \item Reduce $M$ modulo $p$ and compute the characteristic polynomial
    $F_p\in \FF_p[X]$.
  \item Is $F_p$ irreducible?  If so, $p$ is a prime of type I.
  \item Factor $F_p$ over $\FF_p$ and use this factorization to decide whether
    $p$ is a prime of type II or III.
  \item Repeat from step~(\ref{itm:random}) until we have found at
    least one prime of each type.
\end{enumerate}

According to Propositions~\ref{prop:type1}, \ref{prop:type2} and
\ref{prop:type3}, we expect to look on average at $d$ primes before we find
one of type I, at $\sqrt{d}$ primes to find one of type II, and at $3\log d$
primes to find one of type III.

The actual performance of this algorithm (as well as a comparison to the
consecutive version of the algorithm, used in~\cite{ConreyFarmer}) is
illustrated in Figure~\ref{fig:histogram}.  Some care needs to be taken in
interpreting the graphs:
\begin{itemize}
  \item There is no difference in running times for Steps~(\ref{itm:vmbasis}) 
    and~(\ref{itm:hecke}), which 
    are common between the two algorithms.
  \item As the weight increases, the major component of the running time is
    finding a prime of type I.  Therefore, even though the randomized
    algorithm does much better at finding primes of types II and III, this
    advantage has only a minor impact on the overall running time.
  \item In the range illustrated in the graphs (i.e. weights less than
    $\numprint{2000}$), the randomized algorithm required on average one third
    of the number of primes needed by the consecutive algorithm.  However,
    some of this is counteracted by the fact that the consecutive algorithm
    works with smaller primes, which are faster to test.
\end{itemize}

Overall, for weights less than $\numprint{2000}$, the randomized algorithm was
about twice as fast as the consecutive one.  

TODO: find out which component of Sage is used in the main steps.

TODO: get timings for each main step for a large weight $k$.



We now state our main result.

\begin{theorem}\label{thm:main}
  Let $k\leq \bound$ and let
  \begin{align*}
    n\in &\{2,\ldots,\numprint{10000}\}\cup
    \{p\text{ prime}\mid 2\leq p\leq\numprint{4000000}\}\\
    &\cup\{p\text{ prime}\mid p\not\equiv\pm 1\pmod{5}\}\cup
    \{p\text{ prime}\mid p\not\equiv\pm 1\pmod{7}\}.
  \end{align*}
  Let $F$ be the characteristic polynomial of the
  Hecke operator $T_n$ acting on the space $S_k$ of cusp forms of weight
  $k$ and level $1$.  Then $F$ is irreducible over $\QQ$ and the Galois
  group of its splitting field is the full symmetric group $\SS_d$, 
  where $d$ is the dimension of the space $S_k$.
\end{theorem}
\begin{proof}
  The statement for $T_2$ is the result of our computations.  Given this, we
  deduce the result for the other $T_n$ by applying the results of
  Conrey-Farmer-Wallace and Ahlgren, stated above as Theorems~\ref{thm:CFW}
  and~\ref{thm:Ahl}.
\end{proof}

\begin{figure}[h]
\begin{center}
\includegraphics[width=4in, height=2.2in]{type1.png}

\includegraphics[width=4in, height=2.2in]{type2.png}

\includegraphics[width=4in, height=2.2in]{type3.png}
\end{center}
\caption{Histograms illustrating the number of primes tested before finding a
  prime of type I, II, respectively III, in weights up to $\numprint{2000}$.  
  In each graph, the numbers on the
$x$-axis represent the ratio $N/E$ of the actual number of primes tested over
the expected number of primes (coming from the densities described in
Section~\ref{sect:density}).  The $y$-value represents the number of weights
featuring (a small neighborhood of) that particular ratio $N/E$.  The blue 
continuous line corresponds to our randomized algorithm, while the red dotted 
line corresponds to the consecutive algorithm from~\cite{ConreyFarmer}.  
As an example: in the top graph, the global maximum on the continuous line is
at $(0.1, 101)$, meaning that for $101$ weights, the number of candidates for
a prime of type I tested in the randomized algorithm was about $1/10$ of the 
expected number of primes.}
\label{fig:histogram}
\end{figure}


\section{Some applications}

We record some immediate consequences of Theorem~\ref{thm:main}.

\subsection{Non-vanishing of $L$-functions}
Recall that the \emph{$L$-function} associated to an eigenform 
$f=\sum_{n=1}^\infty a_n q^n$ of weight $k$ is given by
\begin{equation*}
  L(f, s)=\sum_{n=1}^\infty \frac{a_n}{n^s}.
\end{equation*}
If $k\equiv 2\pmod{4}$, the functional equation of $L$ implies that
$L(f, k/2)=0$.  It is believed that if $k\equiv 0\pmod{4}$, then $L(f, k/2)\neq
0$.  The following result follows immediately from work of Conrey-Farmer: 

\begin{corollary}[see Theorem 1 in~\cite{ConreyFarmer}]
  Suppose $k\equiv 0\pmod{4}$ and $k\leq\bound$.  Then
  $L(f, k/2)\neq 0$ for any cuspidal eigenform $f$ of level $1$ and weight $k$.
\end{corollary}

\subsection{Distinguishing Hecke eigenforms}

How many initial Fourier coefficients are necessary to completely determine a
Hecke eigenform?  Theorem 1 in~\cite{Ghitza} says that $a_2$, $a_3$ and $a_4$
are sufficient, but our computational verification of Maeda's conjecture gives
a stronger result:

\begin{corollary}[see Theorem 6 in~\cite{Ghitza}]
  Comparing the Fourier coefficient $a_2$ is sufficient to distinguish any two
  cuspidal eigenforms of level $1$ and weights $\leq\numprint{10000}$.
\end{corollary}


\printbibliography

\end{document}


